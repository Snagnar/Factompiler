# Test 4: Memory operations and stateful logic
# Tests: Memory declaration, read(), write(), memory persistence

Signal input_value = ("iron-plate", 50);

# Read current values
Memory state: "signal-S";
write(("signal-S", 0), state, when=once);
Signal current_state = read(state);
Signal next_state = (current_state + 1) % 4;
write(next_state, state, when=1);

# Increment counter every tick

# Conditional memory update

# Memory-based state machine

# Use state for output
Signal output_multiplier = (current_state == 2) * 10 + 1;
Signal final_output = input_value * output_multiplier;
