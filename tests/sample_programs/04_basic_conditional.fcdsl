# Minimal test for conditional memory writes
# A counter increments every tick
# A checkpoint memory only updates when counter is divisible by 4
# Expected behavior: checkpoint holds values 0, 4, 8, 12, 16, ...

Memory counter: "signal-A";
Memory checkpoint: "signal-B";

counter.write(counter.read() + 1);
Signal condition = counter.read() % 4;
checkpoint.write(checkpoint.read() + 1, when=condition == 0);

Signal fast = counter.read();
Signal slow = checkpoint.read();

Entity lamp1 = place("small-lamp", 0, 0);
lamp1.enable = fast % 2 == 0;

Entity lamp2 = place("small-lamp", 0, 4);
lamp2.enable = slow % 2 == 0;
